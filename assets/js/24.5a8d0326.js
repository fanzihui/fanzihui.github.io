(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{480:function(e,a,n){"use strict";n.r(a);var s=n(2),t=Object(s.a)({},(function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("p",[e._v("今天遇到了TCP发送太快 Netty 出现了粘包和拆包得问题")]),e._v(" "),n("p",[e._v("解决这个问题可以使用 netty 自带的 3 种方法")]),e._v(" "),n("p",[e._v("处理拆/粘包的方式有以下几种。")]),e._v(" "),n("p",[e._v("1、定长，对于不满规定长度的帧用规定的特殊字符填满")]),e._v(" "),n("p",[e._v("2、在每一帧的结尾加上特殊字符，作为每一帧的结尾")]),e._v(" "),n("p",[e._v("3、将每一帧分为帧头和帧尾。帧头中包含帧的长度信息。")]),e._v(" "),n("p",[e._v("上面三种方式是比较通用的解决拆/粘包问题的方式。")]),e._v(" "),n("p",[e._v("对于上面")]),e._v(" "),n("p",[e._v("第一种方式要考虑如果帧长超过规定长度怎么办。")]),e._v(" "),n("p",[e._v("第二种就要考虑如果帧中出现了规定做为帧尾的特殊字符怎么办。")]),e._v(" "),n("p",[e._v("第三种会出现跟第一种方式一样的问题，例如我们规定帧头为2个字节，那么两个字节一次可以表示65535个字节，如果帧长超过这个数字怎么办。")]),e._v(" "),n("p",[e._v("在netty中，上面三种方式处理方式都是有实现的。")]),e._v(" "),n("p",[e._v("第一种：FixedLengthFrameDecoder")]),e._v(" "),n("p",[e._v("第二种：LineBaseFrameDecoder或者DelimiterBaseDecoder")]),e._v(" "),n("p",[e._v("第三种：LengthFieldFrameDecoder")]),e._v(" "),n("p",[e._v("FixdLengthFrameDecoder  自动完成对定长消息的解码")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v(" //5 表示5个长度; 如：客户端输入“aaaaaa” ---\x3e 服务端 只会接收到 “aaaaa” ; 所以数据实在不够的时候 以空位补空格。\n\nch.pipeline().addLast(new FixedLengthFrameDecoder(5)); \n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[e._v("LineBasedFrameDecoder 主要代码演示:")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("  ch.pipeline().addLast(new LineBasedFrameDecoder(1024)); \n  ch.pipeline().addLast(new StringDecoder());\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("p",[e._v("DelimiterBaseFrameDecoder 自定义的分隔符")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('  ByteBuf delimiter = Unpooled.copiedBuffer("$_".getBytes());\n  ch.pipeline().addLast(new    DelimiterBasedFrameDecoder(1024,delimiter));\n  ch.pipeline().addLast(new StringDecoder());\n  ch.pipeline().addLast(new EchoClientHandler());\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);